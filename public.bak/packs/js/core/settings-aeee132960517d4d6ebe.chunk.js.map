{"version":3,"sources":["webpack:///./node_modules/escape-html/index.js","webpack:///app/javascript/home/mastodon/live/app/javascript/mastodon/features/emoji/emoji_compressed.js","webpack:///app/javascript/home/mastodon/live/app/javascript/mastodon/features/emoji/unicode_to_filename.js","webpack:///app/javascript/home/mastodon/live/app/javascript/mastodon/initial_state.js","webpack:///./node_modules/@rails/ujs/lib/assets/compiled/rails-ujs.js","webpack:///app/javascript/home/mastodon/live/app/javascript/packs/public-path.js","webpack:///app/javascript/home/mastodon/live/app/javascript/mastodon/ready.js","webpack:///app/javascript/home/mastodon/live/app/javascript/mastodon/features/emoji/emoji_unicode_mapping_light.js","webpack:///./node_modules/substring-trie/index.js","webpack:///app/javascript/home/mastodon/live/app/javascript/mastodon/features/emoji/emoji.js","webpack:///app/javascript/home/mastodon/live/app/javascript/mastodon/utils/config.js","webpack:///app/javascript/home/mastodon/live/app/javascript/core/settings.js"],"names":["matchHtmlRegExp","module","exports","string","escape","str","match","exec","html","index","lastIndex","length","charCodeAt","substring","unicodeToFilename","result","charCode","p","i","toString","element","document","getElementById","initialState","textContent","JSON","parse","getMeta","prop","meta","autoPlayGif","boostModal","cropImages","deleteModal","disableSwiping","disabledAccountId","displayMedia","domain","expandSpoilers","forceSingleColumn","mascot","maxReactions","max_reactions","me","movedToAccountId","owner","profile_directory","reduceMotion","registrationsOpen","searchEnabled","showTrends","singleUserMode","source_url","timelinePreview","title","trendsAsLanding","unfollowModal","useBlurhash","usePendingItems","version","visibleReactions","languages","statusPageUrl","maxChars","max_toot_chars","this","Rails","linkClickSelector","buttonClickSelector","selector","exclude","inputChangeSelector","formSubmitSelector","formInputClickSelector","formDisableSelector","formEnableSelector","fileInputSelector","linkDisableSelector","buttonDisableSelector","call","nonce","loadCSPNonce","ref","querySelector","content","cspNonce","m","Element","prototype","matches","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","getData","key","setData","value","$","Array","slice","querySelectorAll","csrfParam","csrfToken","CSRFProtection","xhr","token","setRequestHeader","refreshCSRFTokens","param","forEach","input","CustomEvent","fire","preventDefault","window","event","params","evt","createEvent","initCustomEvent","bubbles","cancelable","detail","Event","defaultPrevented","Object","defineProperty","get","obj","name","data","dispatchEvent","stopEverything","e","target","stopPropagation","stopImmediatePropagation","delegate","eventType","handler","addEventListener","parentNode","AcceptHeaders","createXHR","prepareOptions","processResponse","text","xml","json","script","ajax","options","response","responseText","getResponseHeader","Math","floor","status","success","statusText","error","complete","beforeSend","readyState","XMLHttpRequest","OPENED","send","url","location","href","type","toUpperCase","indexOf","dataType","accept","done","open","crossDomain","withCredentials","onreadystatechange","DONE","parser","createElement","setAttribute","head","appendChild","removeChild","DOMParser","replace","parseFromString","isCrossDomain","originAnchor","urlAnchor","protocol","host","toArray","serializeElement","additionalParam","inputs","elements","disabled","option","selected","push","checked","map","encodeURIComponent","join","formElements","form","filter","el","allowAction","handleConfirm","confirm","message","answer","callback","getAttribute","disableFormElement","disableFormElements","disableLinkElement","enableFormElement","enableFormElements","enableLinkElement","isXhrRedirect","handleDisabledElement","enableElement","disableElement","replacement","innerHTML","originalText","removeEventListener","handleMethod","formContent","link","method","action","style","display","body","click","isRemote","handleRemote","button","enctype","FormData","append","args","arguments","formSubmitButtonClick","formNoValidate","preventInsignificantClick","insignificantMetaClick","metaKey","ctrlKey","jQuery","rails","Error","ajaxPrefilter","originalOptions","start","_rails_loaded","setTimeout","removeOuterSlashes","cdnHost","__webpack_public_path__","path","formattedHost","test","formatPublicPath","process","ready","Promise","resolve","reject","loaded","_result","err","then","catch","includes","shortCodesToEmojiData","skins","categories","short_names","emojisWithoutShortCodes","require","unicodeMapping","processEmojiMapData","emojiMapData","shortCode","native","filename","keys","filenameData","MiniTrie","words","_dict","len","word","dict","j","len2","char","charAt","search","stack","pop","trie","Trie","emojiFilenames","emojis","v","darkEmoji","lightEmoji","emojiFilename","classList","contains","emojifyTextNode","node","customEmojis","fragment","DocumentFragment","codePointAt","rend","shortname","static_url","assetHost","createTextNode","parentElement","replaceChild","emojifyNode","child","childNodes","nodeType","Node","TEXT_NODE","ELEMENT_NODE","emojify","wrapper","buildCustomEmojis","emoji","shortcode","id","emoticons","keywords","imageUrl","custom","customCategory","categoriesFromEmojis","reduce","set","add","Set","_ref","escapeTextContentForBrowser","dataset","default","_ref2","avatar","file","files","URL","createObjectURL","originalSrc","src","_ref3","header","_ref4","lock","hidden","_ref5","focus","select","setSelectionRange","_ref6","oldReadOnly","readonly","execCommand","blur","remove","console"],"mappings":"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","file":"js/core/settings-aeee132960517d4d6ebe.chunk.js","sourcesContent":["/*!\n * escape-html\n * Copyright(c) 2012-2013 TJ Holowaychuk\n * Copyright(c) 2015 Andreas Lubbe\n * Copyright(c) 2015 Tiancheng \"Timothy\" Gu\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module variables.\n * @private\n */\nvar matchHtmlRegExp = /[\"'&<>]/;\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = escapeHtml;\n\n/**\n * Escape special characters in the given string of html.\n *\n * @param  {string} string The string to escape for inserting into HTML\n * @return {string}\n * @public\n */\n\nfunction escapeHtml(string) {\n  var str = '' + string;\n  var match = matchHtmlRegExp.exec(str);\n  if (!match) {\n    return str;\n  }\n  var escape;\n  var html = '';\n  var index = 0;\n  var lastIndex = 0;\n  for (index = match.index; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34:\n        // \"\n        escape = '&quot;';\n        break;\n      case 38:\n        // &\n        escape = '&amp;';\n        break;\n      case 39:\n        // '\n        escape = '&#39;';\n        break;\n      case 60:\n        // <\n        escape = '&lt;';\n        break;\n      case 62:\n        // >\n        escape = '&gt;';\n        break;\n      default:\n        continue;\n    }\n    if (lastIndex !== index) {\n      html += str.substring(lastIndex, index);\n    }\n    lastIndex = index + 1;\n    html += escape;\n  }\n  return lastIndex !== index ? html + str.substring(lastIndex, index) : html;\n}","// @preval\n// http://www.unicode.org/Public/emoji/5.0/emoji-test.txt\n// This file contains the compressed version of the emoji data from\n// both emoji_map.json and from emoji-mart's emojiIndex and data objects.\n// It's designed to be emitted in an array format to take up less space\n// over the wire.\n\nconst { unicodeToFilename } = require('./unicode_to_filename');\nconst { unicodeToUnifiedName } = require('./unicode_to_unified_name');\nconst emojiMap = require('./emoji_map.json');\nconst { emojiIndex } = require('emoji-mart');\nconst { uncompress: emojiMartUncompress } = require('emoji-mart/dist/utils/data');\n\nlet data = require('emoji-mart/data/all.json');\n\nif(data.compressed) {\n  data = emojiMartUncompress(data);\n}\n\nconst emojiMartData = data;\n\nconst excluded       = ['®', '©', '™'];\nconst skinTones      = ['🏻', '🏼', '🏽', '🏾', '🏿'];\nconst shortcodeMap   = {};\n\nconst shortCodesToEmojiData = {};\nconst emojisWithoutShortCodes = [];\n\nObject.keys(emojiIndex.emojis).forEach(key => {\n  let emoji = emojiIndex.emojis[key];\n\n  // Emojis with skin tone modifiers are stored like this\n  if (Object.prototype.hasOwnProperty.call(emoji, '1')) {\n    emoji = emoji['1'];\n  }\n\n  shortcodeMap[emoji.native] = emoji.id;\n});\n\nconst stripModifiers = unicode => {\n  skinTones.forEach(tone => {\n    unicode = unicode.replace(tone, '');\n  });\n\n  return unicode;\n};\n\nObject.keys(emojiMap).forEach(key => {\n  if (excluded.includes(key)) {\n    delete emojiMap[key];\n    return;\n  }\n\n  const normalizedKey = stripModifiers(key);\n  let shortcode       = shortcodeMap[normalizedKey];\n\n  if (!shortcode) {\n    shortcode = shortcodeMap[normalizedKey + '\\uFE0F'];\n  }\n\n  const filename = emojiMap[key];\n\n  const filenameData = [key];\n\n  if (unicodeToFilename(key) !== filename) {\n    // filename can't be derived using unicodeToFilename\n    filenameData.push(filename);\n  }\n\n  if (typeof shortcode === 'undefined') {\n    emojisWithoutShortCodes.push(filenameData);\n  } else {\n    if (!Array.isArray(shortCodesToEmojiData[shortcode])) {\n      shortCodesToEmojiData[shortcode] = [[]];\n    }\n\n    shortCodesToEmojiData[shortcode][0].push(filenameData);\n  }\n});\n\nObject.keys(emojiIndex.emojis).forEach(key => {\n  let emoji = emojiIndex.emojis[key];\n\n  // Emojis with skin tone modifiers are stored like this\n  if (Object.prototype.hasOwnProperty.call(emoji, '1')) {\n    emoji = emoji['1'];\n  }\n\n  const { native } = emoji;\n  let { short_names, search, unified } = emojiMartData.emojis[key];\n\n  if (short_names[0] !== key) {\n    throw new Error('The compressor expects the first short_code to be the ' +\n      'key. It may need to be rewritten if the emoji change such that this ' +\n      'is no longer the case.');\n  }\n\n  short_names = short_names.slice(1); // first short name can be inferred from the key\n\n  const searchData = [native, short_names, search];\n\n  if (unicodeToUnifiedName(native) !== unified) {\n    // unified name can't be derived from unicodeToUnifiedName\n    searchData.push(unified);\n  }\n\n  if (!Array.isArray(shortCodesToEmojiData[key])) {\n    shortCodesToEmojiData[key] = [[]];\n  }\n\n  shortCodesToEmojiData[key].push(searchData);\n});\n\n// JSON.parse/stringify is to emulate what @preval is doing and avoid any\n// inconsistent behavior in dev mode\nmodule.exports = JSON.parse(JSON.stringify([\n  shortCodesToEmojiData,\n  emojiMartData.skins,\n  emojiMartData.categories,\n  emojiMartData.aliases,\n  emojisWithoutShortCodes,\n]));\n","// taken from:\n// https://github.com/twitter/twemoji/blob/47732c7/twemoji-generator.js#L848-L866\nexports.unicodeToFilename = (str) => {\n  let result = '';\n  let charCode = 0;\n  let p = 0;\n  let i = 0;\n  while (i < str.length) {\n    charCode = str.charCodeAt(i++);\n    if (p) {\n      if (result.length > 0) {\n        result += '-';\n      }\n      result += (0x10000 + ((p - 0xD800) << 10) + (charCode - 0xDC00)).toString(16);\n      p = 0;\n    } else if (0xD800 <= charCode && charCode <= 0xDBFF) {\n      p = charCode;\n    } else {\n      if (result.length > 0) {\n        result += '-';\n      }\n      result += charCode.toString(16);\n    }\n  }\n  return result;\n};\n","// @ts-check\n\n/**\n * @typedef Emoji\n * @property {string} shortcode\n * @property {string} static_url\n * @property {string} url\n */\n\n/**\n * @typedef AccountField\n * @property {string} name\n * @property {string} value\n * @property {string} verified_at\n */\n\n/**\n * @typedef Account\n * @property {string} acct\n * @property {string} avatar\n * @property {string} avatar_static\n * @property {boolean} bot\n * @property {string} created_at\n * @property {boolean=} discoverable\n * @property {string} display_name\n * @property {Emoji[]} emojis\n * @property {AccountField[]} fields\n * @property {number} followers_count\n * @property {number} following_count\n * @property {boolean} group\n * @property {string} header\n * @property {string} header_static\n * @property {string} id\n * @property {string=} last_status_at\n * @property {boolean} locked\n * @property {string} note\n * @property {number} statuses_count\n * @property {string} url\n * @property {string} username\n */\n\n/**\n * @typedef {[code: string, name: string, localName: string]} InitialStateLanguage\n */\n\n/**\n * @typedef InitialStateMeta\n * @property {string} access_token\n * @property {boolean=} advanced_layout\n * @property {boolean} auto_play_gif\n * @property {boolean} activity_api_enabled\n * @property {string} admin\n * @property {boolean=} boost_modal\n * @property {boolean} crop_images\n * @property {boolean=} delete_modal\n * @property {boolean=} disable_swiping\n * @property {string=} disabled_account_id\n * @property {boolean} display_media\n * @property {string} domain\n * @property {boolean=} expand_spoilers\n * @property {boolean} limited_federation_mode\n * @property {string} locale\n * @property {string | null} mascot\n * @property {number} max_reactions\n * @property {string=} me\n * @property {string=} moved_to_account_id\n * @property {string=} owner\n * @property {boolean} profile_directory\n * @property {boolean} registrations_open\n * @property {boolean} reduce_motion\n * @property {string} repository\n * @property {boolean} search_enabled\n * @property {boolean} single_user_mode\n * @property {string} source_url\n * @property {string} streaming_api_base_url\n * @property {boolean} timeline_preview\n * @property {string} title\n * @property {boolean} trends\n * @property {boolean} trends_as_landing_page\n * @property {boolean} unfollow_modal\n * @property {boolean} use_blurhash\n * @property {boolean=} use_pending_items\n * @property {string} version\n * @property {number} visible_reactions\n * @property {boolean} translation_enabled\n */\n\n/**\n * @typedef InitialState\n * @property {Record<string, Account>} accounts\n * @property {InitialStateLanguage[]} languages\n * @property {InitialStateMeta} meta\n */\n\nconst element = document.getElementById('initial-state');\n/** @type {InitialState | undefined} */\nconst initialState = element?.textContent && JSON.parse(element.textContent);\n\n/**\n * @template {keyof InitialStateMeta} K\n * @param {K} prop\n * @returns {InitialStateMeta[K] | undefined}\n */\nconst getMeta = (prop) => initialState?.meta && initialState.meta[prop];\n\nexport const activityApiEnabled = getMeta('activity_api_enabled');\nexport const autoPlayGif = getMeta('auto_play_gif');\nexport const boostModal = getMeta('boost_modal');\nexport const cropImages = getMeta('crop_images');\nexport const deleteModal = getMeta('delete_modal');\nexport const disableSwiping = getMeta('disable_swiping');\nexport const disabledAccountId = getMeta('disabled_account_id');\nexport const displayMedia = getMeta('display_media');\nexport const domain = getMeta('domain');\nexport const expandSpoilers = getMeta('expand_spoilers');\nexport const forceSingleColumn = !getMeta('advanced_layout');\nexport const limitedFederationMode = getMeta('limited_federation_mode');\nexport const mascot = getMeta('mascot');\nexport const maxReactions = (initialState && initialState.max_reactions) || 1;\nexport const me = getMeta('me');\nexport const movedToAccountId = getMeta('moved_to_account_id');\nexport const owner = getMeta('owner');\nexport const profile_directory = getMeta('profile_directory');\nexport const reduceMotion = getMeta('reduce_motion');\nexport const registrationsOpen = getMeta('registrations_open');\nexport const repository = getMeta('repository');\nexport const searchEnabled = getMeta('search_enabled');\nexport const showTrends = getMeta('trends');\nexport const singleUserMode = getMeta('single_user_mode');\nexport const source_url = getMeta('source_url');\nexport const timelinePreview = getMeta('timeline_preview');\nexport const title = getMeta('title');\nexport const trendsAsLanding = getMeta('trends_as_landing_page');\nexport const unfollowModal = getMeta('unfollow_modal');\nexport const useBlurhash = getMeta('use_blurhash');\nexport const usePendingItems = getMeta('use_pending_items');\nexport const version = getMeta('version');\nexport const visibleReactions = getMeta('visible_reactions');\nexport const translationEnabled = getMeta('translation_enabled');\nexport const languages = initialState?.languages;\nexport const statusPageUrl = getMeta('status_page_url');\n\n// Glitch-soc-specific settings\nexport const maxChars = (initialState && initialState.max_toot_chars) || 500;\n\nexport default initialState;\n","/*\nUnobtrusive JavaScript\nhttps://github.com/rails/rails/blob/main/actionview/app/assets/javascripts\nReleased under the MIT license\n */;\n(function () {\n  var context = this;\n  (function () {\n    (function () {\n      this.Rails = {\n        linkClickSelector: 'a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]',\n        buttonClickSelector: {\n          selector: 'button[data-remote]:not([form]), button[data-confirm]:not([form])',\n          exclude: 'form button'\n        },\n        inputChangeSelector: 'select[data-remote], input[data-remote], textarea[data-remote]',\n        formSubmitSelector: 'form:not([data-turbo=true])',\n        formInputClickSelector: 'form:not([data-turbo=true]) input[type=submit], form:not([data-turbo=true]) input[type=image], form:not([data-turbo=true]) button[type=submit], form:not([data-turbo=true]) button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])',\n        formDisableSelector: 'input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled',\n        formEnableSelector: 'input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled',\n        fileInputSelector: 'input[name][type=file]:not([disabled])',\n        linkDisableSelector: 'a[data-disable-with], a[data-disable]',\n        buttonDisableSelector: 'button[data-remote][data-disable-with], button[data-remote][data-disable]'\n      };\n    }).call(this);\n  }).call(context);\n  var Rails = context.Rails;\n  (function () {\n    (function () {\n      var nonce;\n      nonce = null;\n      Rails.loadCSPNonce = function () {\n        var ref;\n        return nonce = (ref = document.querySelector(\"meta[name=csp-nonce]\")) != null ? ref.content : void 0;\n      };\n      Rails.cspNonce = function () {\n        return nonce != null ? nonce : Rails.loadCSPNonce();\n      };\n    }).call(this);\n    (function () {\n      var expando, m;\n      m = Element.prototype.matches || Element.prototype.matchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.oMatchesSelector || Element.prototype.webkitMatchesSelector;\n      Rails.matches = function (element, selector) {\n        if (selector.exclude != null) {\n          return m.call(element, selector.selector) && !m.call(element, selector.exclude);\n        } else {\n          return m.call(element, selector);\n        }\n      };\n      expando = '_ujsData';\n      Rails.getData = function (element, key) {\n        var ref;\n        return (ref = element[expando]) != null ? ref[key] : void 0;\n      };\n      Rails.setData = function (element, key, value) {\n        if (element[expando] == null) {\n          element[expando] = {};\n        }\n        return element[expando][key] = value;\n      };\n      Rails.$ = function (selector) {\n        return Array.prototype.slice.call(document.querySelectorAll(selector));\n      };\n    }).call(this);\n    (function () {\n      var $, csrfParam, csrfToken;\n      $ = Rails.$;\n      csrfToken = Rails.csrfToken = function () {\n        var meta;\n        meta = document.querySelector('meta[name=csrf-token]');\n        return meta && meta.content;\n      };\n      csrfParam = Rails.csrfParam = function () {\n        var meta;\n        meta = document.querySelector('meta[name=csrf-param]');\n        return meta && meta.content;\n      };\n      Rails.CSRFProtection = function (xhr) {\n        var token;\n        token = csrfToken();\n        if (token != null) {\n          return xhr.setRequestHeader('X-CSRF-Token', token);\n        }\n      };\n      Rails.refreshCSRFTokens = function () {\n        var param, token;\n        token = csrfToken();\n        param = csrfParam();\n        if (token != null && param != null) {\n          return $('form input[name=\"' + param + '\"]').forEach(function (input) {\n            return input.value = token;\n          });\n        }\n      };\n    }).call(this);\n    (function () {\n      var CustomEvent, fire, matches, preventDefault;\n      matches = Rails.matches;\n      CustomEvent = window.CustomEvent;\n      if (typeof CustomEvent !== 'function') {\n        CustomEvent = function (event, params) {\n          var evt;\n          evt = document.createEvent('CustomEvent');\n          evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n          return evt;\n        };\n        CustomEvent.prototype = window.Event.prototype;\n        preventDefault = CustomEvent.prototype.preventDefault;\n        CustomEvent.prototype.preventDefault = function () {\n          var result;\n          result = preventDefault.call(this);\n          if (this.cancelable && !this.defaultPrevented) {\n            Object.defineProperty(this, 'defaultPrevented', {\n              get: function () {\n                return true;\n              }\n            });\n          }\n          return result;\n        };\n      }\n      fire = Rails.fire = function (obj, name, data) {\n        var event;\n        event = new CustomEvent(name, {\n          bubbles: true,\n          cancelable: true,\n          detail: data\n        });\n        obj.dispatchEvent(event);\n        return !event.defaultPrevented;\n      };\n      Rails.stopEverything = function (e) {\n        fire(e.target, 'ujs:everythingStopped');\n        e.preventDefault();\n        e.stopPropagation();\n        return e.stopImmediatePropagation();\n      };\n      Rails.delegate = function (element, selector, eventType, handler) {\n        return element.addEventListener(eventType, function (e) {\n          var target;\n          target = e.target;\n          while (!(!(target instanceof Element) || matches(target, selector))) {\n            target = target.parentNode;\n          }\n          if (target instanceof Element && handler.call(target, e) === false) {\n            e.preventDefault();\n            return e.stopPropagation();\n          }\n        });\n      };\n    }).call(this);\n    (function () {\n      var AcceptHeaders, CSRFProtection, createXHR, cspNonce, fire, prepareOptions, processResponse;\n      cspNonce = Rails.cspNonce, CSRFProtection = Rails.CSRFProtection, fire = Rails.fire;\n      AcceptHeaders = {\n        '*': '*/*',\n        text: 'text/plain',\n        html: 'text/html',\n        xml: 'application/xml, text/xml',\n        json: 'application/json, text/javascript',\n        script: 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript'\n      };\n      Rails.ajax = function (options) {\n        var xhr;\n        options = prepareOptions(options);\n        xhr = createXHR(options, function () {\n          var ref, response;\n          response = processResponse((ref = xhr.response) != null ? ref : xhr.responseText, xhr.getResponseHeader('Content-Type'));\n          if (Math.floor(xhr.status / 100) === 2) {\n            if (typeof options.success === \"function\") {\n              options.success(response, xhr.statusText, xhr);\n            }\n          } else {\n            if (typeof options.error === \"function\") {\n              options.error(response, xhr.statusText, xhr);\n            }\n          }\n          return typeof options.complete === \"function\" ? options.complete(xhr, xhr.statusText) : void 0;\n        });\n        if (options.beforeSend != null && !options.beforeSend(xhr, options)) {\n          return false;\n        }\n        if (xhr.readyState === XMLHttpRequest.OPENED) {\n          return xhr.send(options.data);\n        }\n      };\n      prepareOptions = function (options) {\n        options.url = options.url || location.href;\n        options.type = options.type.toUpperCase();\n        if (options.type === 'GET' && options.data) {\n          if (options.url.indexOf('?') < 0) {\n            options.url += '?' + options.data;\n          } else {\n            options.url += '&' + options.data;\n          }\n        }\n        if (AcceptHeaders[options.dataType] == null) {\n          options.dataType = '*';\n        }\n        options.accept = AcceptHeaders[options.dataType];\n        if (options.dataType !== '*') {\n          options.accept += ', */*; q=0.01';\n        }\n        return options;\n      };\n      createXHR = function (options, done) {\n        var xhr;\n        xhr = new XMLHttpRequest();\n        xhr.open(options.type, options.url, true);\n        xhr.setRequestHeader('Accept', options.accept);\n        if (typeof options.data === 'string') {\n          xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');\n        }\n        if (!options.crossDomain) {\n          xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n          CSRFProtection(xhr);\n        }\n        xhr.withCredentials = !!options.withCredentials;\n        xhr.onreadystatechange = function () {\n          if (xhr.readyState === XMLHttpRequest.DONE) {\n            return done(xhr);\n          }\n        };\n        return xhr;\n      };\n      processResponse = function (response, type) {\n        var parser, script;\n        if (typeof response === 'string' && typeof type === 'string') {\n          if (type.match(/\\bjson\\b/)) {\n            try {\n              response = JSON.parse(response);\n            } catch (error) {}\n          } else if (type.match(/\\b(?:java|ecma)script\\b/)) {\n            script = document.createElement('script');\n            script.setAttribute('nonce', cspNonce());\n            script.text = response;\n            document.head.appendChild(script).parentNode.removeChild(script);\n          } else if (type.match(/\\b(xml|html|svg)\\b/)) {\n            parser = new DOMParser();\n            type = type.replace(/;.+/, '');\n            try {\n              response = parser.parseFromString(response, type);\n            } catch (error) {}\n          }\n        }\n        return response;\n      };\n      Rails.href = function (element) {\n        return element.href;\n      };\n      Rails.isCrossDomain = function (url) {\n        var e, originAnchor, urlAnchor;\n        originAnchor = document.createElement('a');\n        originAnchor.href = location.href;\n        urlAnchor = document.createElement('a');\n        try {\n          urlAnchor.href = url;\n          return !((!urlAnchor.protocol || urlAnchor.protocol === ':') && !urlAnchor.host || originAnchor.protocol + '//' + originAnchor.host === urlAnchor.protocol + '//' + urlAnchor.host);\n        } catch (error) {\n          e = error;\n          return true;\n        }\n      };\n    }).call(this);\n    (function () {\n      var matches, toArray;\n      matches = Rails.matches;\n      toArray = function (e) {\n        return Array.prototype.slice.call(e);\n      };\n      Rails.serializeElement = function (element, additionalParam) {\n        var inputs, params;\n        inputs = [element];\n        if (matches(element, 'form')) {\n          inputs = toArray(element.elements);\n        }\n        params = [];\n        inputs.forEach(function (input) {\n          if (!input.name || input.disabled) {\n            return;\n          }\n          if (matches(input, 'fieldset[disabled] *')) {\n            return;\n          }\n          if (matches(input, 'select')) {\n            return toArray(input.options).forEach(function (option) {\n              if (option.selected) {\n                return params.push({\n                  name: input.name,\n                  value: option.value\n                });\n              }\n            });\n          } else if (input.checked || ['radio', 'checkbox', 'submit'].indexOf(input.type) === -1) {\n            return params.push({\n              name: input.name,\n              value: input.value\n            });\n          }\n        });\n        if (additionalParam) {\n          params.push(additionalParam);\n        }\n        return params.map(function (param) {\n          if (param.name != null) {\n            return encodeURIComponent(param.name) + \"=\" + encodeURIComponent(param.value);\n          } else {\n            return param;\n          }\n        }).join('&');\n      };\n      Rails.formElements = function (form, selector) {\n        if (matches(form, 'form')) {\n          return toArray(form.elements).filter(function (el) {\n            return matches(el, selector);\n          });\n        } else {\n          return toArray(form.querySelectorAll(selector));\n        }\n      };\n    }).call(this);\n    (function () {\n      var allowAction, fire, stopEverything;\n      fire = Rails.fire, stopEverything = Rails.stopEverything;\n      Rails.handleConfirm = function (e) {\n        if (!allowAction(this)) {\n          return stopEverything(e);\n        }\n      };\n      Rails.confirm = function (message, element) {\n        return confirm(message);\n      };\n      allowAction = function (element) {\n        var answer, callback, message;\n        message = element.getAttribute('data-confirm');\n        if (!message) {\n          return true;\n        }\n        answer = false;\n        if (fire(element, 'confirm')) {\n          try {\n            answer = Rails.confirm(message, element);\n          } catch (error) {}\n          callback = fire(element, 'confirm:complete', [answer]);\n        }\n        return answer && callback;\n      };\n    }).call(this);\n    (function () {\n      var disableFormElement, disableFormElements, disableLinkElement, enableFormElement, enableFormElements, enableLinkElement, formElements, getData, isXhrRedirect, matches, setData, stopEverything;\n      matches = Rails.matches, getData = Rails.getData, setData = Rails.setData, stopEverything = Rails.stopEverything, formElements = Rails.formElements;\n      Rails.handleDisabledElement = function (e) {\n        var element;\n        element = this;\n        if (element.disabled) {\n          return stopEverything(e);\n        }\n      };\n      Rails.enableElement = function (e) {\n        var element;\n        if (e instanceof Event) {\n          if (isXhrRedirect(e)) {\n            return;\n          }\n          element = e.target;\n        } else {\n          element = e;\n        }\n        if (matches(element, Rails.linkDisableSelector)) {\n          return enableLinkElement(element);\n        } else if (matches(element, Rails.buttonDisableSelector) || matches(element, Rails.formEnableSelector)) {\n          return enableFormElement(element);\n        } else if (matches(element, Rails.formSubmitSelector)) {\n          return enableFormElements(element);\n        }\n      };\n      Rails.disableElement = function (e) {\n        var element;\n        element = e instanceof Event ? e.target : e;\n        if (matches(element, Rails.linkDisableSelector)) {\n          return disableLinkElement(element);\n        } else if (matches(element, Rails.buttonDisableSelector) || matches(element, Rails.formDisableSelector)) {\n          return disableFormElement(element);\n        } else if (matches(element, Rails.formSubmitSelector)) {\n          return disableFormElements(element);\n        }\n      };\n      disableLinkElement = function (element) {\n        var replacement;\n        if (getData(element, 'ujs:disabled')) {\n          return;\n        }\n        replacement = element.getAttribute('data-disable-with');\n        if (replacement != null) {\n          setData(element, 'ujs:enable-with', element.innerHTML);\n          element.innerHTML = replacement;\n        }\n        element.addEventListener('click', stopEverything);\n        return setData(element, 'ujs:disabled', true);\n      };\n      enableLinkElement = function (element) {\n        var originalText;\n        originalText = getData(element, 'ujs:enable-with');\n        if (originalText != null) {\n          element.innerHTML = originalText;\n          setData(element, 'ujs:enable-with', null);\n        }\n        element.removeEventListener('click', stopEverything);\n        return setData(element, 'ujs:disabled', null);\n      };\n      disableFormElements = function (form) {\n        return formElements(form, Rails.formDisableSelector).forEach(disableFormElement);\n      };\n      disableFormElement = function (element) {\n        var replacement;\n        if (getData(element, 'ujs:disabled')) {\n          return;\n        }\n        replacement = element.getAttribute('data-disable-with');\n        if (replacement != null) {\n          if (matches(element, 'button')) {\n            setData(element, 'ujs:enable-with', element.innerHTML);\n            element.innerHTML = replacement;\n          } else {\n            setData(element, 'ujs:enable-with', element.value);\n            element.value = replacement;\n          }\n        }\n        element.disabled = true;\n        return setData(element, 'ujs:disabled', true);\n      };\n      enableFormElements = function (form) {\n        return formElements(form, Rails.formEnableSelector).forEach(enableFormElement);\n      };\n      enableFormElement = function (element) {\n        var originalText;\n        originalText = getData(element, 'ujs:enable-with');\n        if (originalText != null) {\n          if (matches(element, 'button')) {\n            element.innerHTML = originalText;\n          } else {\n            element.value = originalText;\n          }\n          setData(element, 'ujs:enable-with', null);\n        }\n        element.disabled = false;\n        return setData(element, 'ujs:disabled', null);\n      };\n      isXhrRedirect = function (event) {\n        var ref, xhr;\n        xhr = (ref = event.detail) != null ? ref[0] : void 0;\n        return (xhr != null ? xhr.getResponseHeader(\"X-Xhr-Redirect\") : void 0) != null;\n      };\n    }).call(this);\n    (function () {\n      var stopEverything;\n      stopEverything = Rails.stopEverything;\n      Rails.handleMethod = function (e) {\n        var csrfParam, csrfToken, form, formContent, href, link, method;\n        link = this;\n        method = link.getAttribute('data-method');\n        if (!method) {\n          return;\n        }\n        href = Rails.href(link);\n        csrfToken = Rails.csrfToken();\n        csrfParam = Rails.csrfParam();\n        form = document.createElement('form');\n        formContent = \"<input name='_method' value='\" + method + \"' type='hidden' />\";\n        if (csrfParam != null && csrfToken != null && !Rails.isCrossDomain(href)) {\n          formContent += \"<input name='\" + csrfParam + \"' value='\" + csrfToken + \"' type='hidden' />\";\n        }\n        formContent += '<input type=\"submit\" />';\n        form.method = 'post';\n        form.action = href;\n        form.target = link.target;\n        form.innerHTML = formContent;\n        form.style.display = 'none';\n        document.body.appendChild(form);\n        form.querySelector('[type=\"submit\"]').click();\n        return stopEverything(e);\n      };\n    }).call(this);\n    (function () {\n      var ajax,\n        fire,\n        getData,\n        isCrossDomain,\n        isRemote,\n        matches,\n        serializeElement,\n        setData,\n        stopEverything,\n        slice = [].slice;\n      matches = Rails.matches, getData = Rails.getData, setData = Rails.setData, fire = Rails.fire, stopEverything = Rails.stopEverything, ajax = Rails.ajax, isCrossDomain = Rails.isCrossDomain, serializeElement = Rails.serializeElement;\n      isRemote = function (element) {\n        var value;\n        value = element.getAttribute('data-remote');\n        return value != null && value !== 'false';\n      };\n      Rails.handleRemote = function (e) {\n        var button, data, dataType, element, method, url, withCredentials;\n        element = this;\n        if (!isRemote(element)) {\n          return true;\n        }\n        if (!fire(element, 'ajax:before')) {\n          fire(element, 'ajax:stopped');\n          return false;\n        }\n        withCredentials = element.getAttribute('data-with-credentials');\n        dataType = element.getAttribute('data-type') || 'script';\n        if (matches(element, Rails.formSubmitSelector)) {\n          button = getData(element, 'ujs:submit-button');\n          method = getData(element, 'ujs:submit-button-formmethod') || element.method;\n          url = getData(element, 'ujs:submit-button-formaction') || element.getAttribute('action') || location.href;\n          if (method.toUpperCase() === 'GET') {\n            url = url.replace(/\\?.*$/, '');\n          }\n          if (element.enctype === 'multipart/form-data') {\n            data = new FormData(element);\n            if (button != null) {\n              data.append(button.name, button.value);\n            }\n          } else {\n            data = serializeElement(element, button);\n          }\n          setData(element, 'ujs:submit-button', null);\n          setData(element, 'ujs:submit-button-formmethod', null);\n          setData(element, 'ujs:submit-button-formaction', null);\n        } else if (matches(element, Rails.buttonClickSelector) || matches(element, Rails.inputChangeSelector)) {\n          method = element.getAttribute('data-method');\n          url = element.getAttribute('data-url');\n          data = serializeElement(element, element.getAttribute('data-params'));\n        } else {\n          method = element.getAttribute('data-method');\n          url = Rails.href(element);\n          data = element.getAttribute('data-params');\n        }\n        ajax({\n          type: method || 'GET',\n          url: url,\n          data: data,\n          dataType: dataType,\n          beforeSend: function (xhr, options) {\n            if (fire(element, 'ajax:beforeSend', [xhr, options])) {\n              return fire(element, 'ajax:send', [xhr]);\n            } else {\n              fire(element, 'ajax:stopped');\n              return false;\n            }\n          },\n          success: function () {\n            var args;\n            args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n            return fire(element, 'ajax:success', args);\n          },\n          error: function () {\n            var args;\n            args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n            return fire(element, 'ajax:error', args);\n          },\n          complete: function () {\n            var args;\n            args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n            return fire(element, 'ajax:complete', args);\n          },\n          crossDomain: isCrossDomain(url),\n          withCredentials: withCredentials != null && withCredentials !== 'false'\n        });\n        return stopEverything(e);\n      };\n      Rails.formSubmitButtonClick = function (e) {\n        var button, form;\n        button = this;\n        form = button.form;\n        if (!form) {\n          return;\n        }\n        if (button.name) {\n          setData(form, 'ujs:submit-button', {\n            name: button.name,\n            value: button.value\n          });\n        }\n        setData(form, 'ujs:formnovalidate-button', button.formNoValidate);\n        setData(form, 'ujs:submit-button-formaction', button.getAttribute('formaction'));\n        return setData(form, 'ujs:submit-button-formmethod', button.getAttribute('formmethod'));\n      };\n      Rails.preventInsignificantClick = function (e) {\n        var data, insignificantMetaClick, link, metaClick, method, nonPrimaryMouseClick;\n        link = this;\n        method = (link.getAttribute('data-method') || 'GET').toUpperCase();\n        data = link.getAttribute('data-params');\n        metaClick = e.metaKey || e.ctrlKey;\n        insignificantMetaClick = metaClick && method === 'GET' && !data;\n        nonPrimaryMouseClick = e.button != null && e.button !== 0;\n        if (nonPrimaryMouseClick || insignificantMetaClick) {\n          return e.stopImmediatePropagation();\n        }\n      };\n    }).call(this);\n    (function () {\n      var $, CSRFProtection, delegate, disableElement, enableElement, fire, formSubmitButtonClick, getData, handleConfirm, handleDisabledElement, handleMethod, handleRemote, loadCSPNonce, preventInsignificantClick, refreshCSRFTokens;\n      fire = Rails.fire, delegate = Rails.delegate, getData = Rails.getData, $ = Rails.$, refreshCSRFTokens = Rails.refreshCSRFTokens, CSRFProtection = Rails.CSRFProtection, loadCSPNonce = Rails.loadCSPNonce, enableElement = Rails.enableElement, disableElement = Rails.disableElement, handleDisabledElement = Rails.handleDisabledElement, handleConfirm = Rails.handleConfirm, preventInsignificantClick = Rails.preventInsignificantClick, handleRemote = Rails.handleRemote, formSubmitButtonClick = Rails.formSubmitButtonClick, handleMethod = Rails.handleMethod;\n      if (typeof jQuery !== \"undefined\" && jQuery !== null && jQuery.ajax != null) {\n        if (jQuery.rails) {\n          throw new Error('If you load both jquery_ujs and rails-ujs, use rails-ujs only.');\n        }\n        jQuery.rails = Rails;\n        jQuery.ajaxPrefilter(function (options, originalOptions, xhr) {\n          if (!options.crossDomain) {\n            return CSRFProtection(xhr);\n          }\n        });\n      }\n      Rails.start = function () {\n        if (window._rails_loaded) {\n          throw new Error('rails-ujs has already been loaded!');\n        }\n        window.addEventListener('pageshow', function () {\n          $(Rails.formEnableSelector).forEach(function (el) {\n            if (getData(el, 'ujs:disabled')) {\n              return enableElement(el);\n            }\n          });\n          return $(Rails.linkDisableSelector).forEach(function (el) {\n            if (getData(el, 'ujs:disabled')) {\n              return enableElement(el);\n            }\n          });\n        });\n        delegate(document, Rails.linkDisableSelector, 'ajax:complete', enableElement);\n        delegate(document, Rails.linkDisableSelector, 'ajax:stopped', enableElement);\n        delegate(document, Rails.buttonDisableSelector, 'ajax:complete', enableElement);\n        delegate(document, Rails.buttonDisableSelector, 'ajax:stopped', enableElement);\n        delegate(document, Rails.linkClickSelector, 'click', preventInsignificantClick);\n        delegate(document, Rails.linkClickSelector, 'click', handleDisabledElement);\n        delegate(document, Rails.linkClickSelector, 'click', handleConfirm);\n        delegate(document, Rails.linkClickSelector, 'click', disableElement);\n        delegate(document, Rails.linkClickSelector, 'click', handleRemote);\n        delegate(document, Rails.linkClickSelector, 'click', handleMethod);\n        delegate(document, Rails.buttonClickSelector, 'click', preventInsignificantClick);\n        delegate(document, Rails.buttonClickSelector, 'click', handleDisabledElement);\n        delegate(document, Rails.buttonClickSelector, 'click', handleConfirm);\n        delegate(document, Rails.buttonClickSelector, 'click', disableElement);\n        delegate(document, Rails.buttonClickSelector, 'click', handleRemote);\n        delegate(document, Rails.inputChangeSelector, 'change', handleDisabledElement);\n        delegate(document, Rails.inputChangeSelector, 'change', handleConfirm);\n        delegate(document, Rails.inputChangeSelector, 'change', handleRemote);\n        delegate(document, Rails.formSubmitSelector, 'submit', handleDisabledElement);\n        delegate(document, Rails.formSubmitSelector, 'submit', handleConfirm);\n        delegate(document, Rails.formSubmitSelector, 'submit', handleRemote);\n        delegate(document, Rails.formSubmitSelector, 'submit', function (e) {\n          return setTimeout(function () {\n            return disableElement(e);\n          }, 13);\n        });\n        delegate(document, Rails.formSubmitSelector, 'ajax:send', disableElement);\n        delegate(document, Rails.formSubmitSelector, 'ajax:complete', enableElement);\n        delegate(document, Rails.formInputClickSelector, 'click', preventInsignificantClick);\n        delegate(document, Rails.formInputClickSelector, 'click', handleDisabledElement);\n        delegate(document, Rails.formInputClickSelector, 'click', handleConfirm);\n        delegate(document, Rails.formInputClickSelector, 'click', formSubmitButtonClick);\n        document.addEventListener('DOMContentLoaded', refreshCSRFTokens);\n        document.addEventListener('DOMContentLoaded', loadCSPNonce);\n        return window._rails_loaded = true;\n      };\n      if (window.Rails === Rails && fire(document, 'rails:attachBindings')) {\n        Rails.start();\n      }\n    }).call(this);\n  }).call(this);\n  if (typeof module === \"object\" && module.exports) {\n    module.exports = Rails;\n  } else if (typeof define === \"function\" && define.amd) {\n    define(Rails);\n  }\n}).call(this);","// Dynamically set webpack's loading path depending on a meta header, in order\n// to share the same assets regardless of instance configuration.\n// See https://webpack.js.org/guides/public-path/#on-the-fly\n\nfunction removeOuterSlashes(string) {\n  return string.replace(/^\\/*/, '').replace(/\\/*$/, '');\n}\n\nfunction formatPublicPath(host = '', path = '') {\n  let formattedHost = removeOuterSlashes(host);\n  if (formattedHost && !/^http/i.test(formattedHost)) {\n    formattedHost = `//${formattedHost}`;\n  }\n  const formattedPath = removeOuterSlashes(path);\n  return `${formattedHost}/${formattedPath}/`;\n}\n\nconst cdnHost = document.querySelector('meta[name=cdn-host]');\n\n// eslint-disable-next-line no-undef\n__webpack_public_path__ = formatPublicPath(cdnHost ? cdnHost.content : '', process.env.PUBLIC_OUTPUT_PATH);\n","// @ts-check\n\n/**\n * @param {(() => void) | (() => Promise<void>)} callback\n * @returns {Promise<void>}\n */\nexport default function ready(callback) {\n  return new Promise((resolve, reject) => {\n    function loaded() {\n      let result;\n      try {\n        result = callback();\n      } catch (err) {\n        reject(err);\n\n        return;\n      }\n\n      if (typeof result?.then === 'function') {\n        result.then(resolve).catch(reject);\n      } else {\n        resolve();\n      }\n    }\n\n    if (['interactive', 'complete'].includes(document.readyState)) {\n      loaded();\n    } else {\n      document.addEventListener('DOMContentLoaded', loaded);\n    }\n  });\n}\n","// A mapping of unicode strings to an object containing the filename\n// (i.e. the svg filename) and a shortCode intended to be shown\n// as a \"title\" attribute in an HTML element (aka tooltip).\n\nconst [\n  shortCodesToEmojiData,\n  skins, // eslint-disable-line no-unused-vars\n  categories, // eslint-disable-line no-unused-vars\n  short_names, // eslint-disable-line no-unused-vars\n  emojisWithoutShortCodes,\n] = require('./emoji_compressed');\nconst { unicodeToFilename } = require('./unicode_to_filename');\n\n// decompress\nconst unicodeMapping = {};\n\nfunction processEmojiMapData(emojiMapData, shortCode) {\n  let [ native, filename ] = emojiMapData;\n  if (!filename) {\n    // filename name can be derived from unicodeToFilename\n    filename = unicodeToFilename(native);\n  }\n  unicodeMapping[native] = {\n    shortCode: shortCode,\n    filename: filename,\n  };\n}\n\nObject.keys(shortCodesToEmojiData).forEach((shortCode) => {\n  let [ filenameData ] = shortCodesToEmojiData[shortCode];\n  filenameData.forEach(emojiMapData => processEmojiMapData(emojiMapData, shortCode));\n});\nemojisWithoutShortCodes.forEach(emojiMapData => processEmojiMapData(emojiMapData));\n\nmodule.exports = unicodeMapping;\n","'use strict';\n\nvar CODA_MARKER = '$$'; // marks the end of the string\n\nfunction MiniTrie(words) {\n  this._dict = {};\n  for (var i = 0, len = words.length; i < len; i++) {\n    var word = words[i];\n    var dict = this._dict;\n    for (var j = 0, len2 = word.length; j < len2; j++) {\n      var char = word.charAt(j);\n      dict = dict[char] = dict[char] || {};\n    }\n    dict[CODA_MARKER] = true;\n  }\n}\nMiniTrie.prototype.search = function (str) {\n  var i = -1;\n  var len = str.length;\n  var stack = [this._dict];\n  while (++i < len) {\n    var dict = stack[i];\n    var char = str.charAt(i);\n    if (char in dict) {\n      stack.push(dict[char]);\n    } else {\n      break;\n    }\n  }\n  while (stack.length) {\n    if (stack.pop()[CODA_MARKER]) {\n      return str.substring(0, stack.length);\n    }\n  }\n};\nmodule.exports = MiniTrie;","import { autoPlayGif } from '../../initial_state';\nimport unicodeMapping from './emoji_unicode_mapping_light';\nimport { assetHost } from 'mastodon/utils/config';\nimport Trie from 'substring-trie';\n\nconst trie = new Trie(Object.keys(unicodeMapping));\n\n// Convert to file names from emojis. (For different variation selector emojis)\nconst emojiFilenames = (emojis) => {\n  return emojis.map(v => unicodeMapping[v].filename);\n};\n\n// Emoji requiring extra borders depending on theme\nconst darkEmoji = emojiFilenames(['🎱', '🐜', '⚫', '🖤', '⬛', '◼️', '◾', '◼️', '✒️', '▪️', '💣', '🎳', '📷', '📸', '♣️', '🕶️', '✴️', '🔌', '💂‍♀️', '📽️', '🍳', '🦍', '💂', '🔪', '🕳️', '🕹️', '🕋', '🖊️', '🖋️', '💂‍♂️', '🎤', '🎓', '🎥', '🎼', '♠️', '🎩', '🦃', '📼', '📹', '🎮', '🐃', '🏴', '🐞', '🕺', '📱', '📲', '🚲']);\nconst lightEmoji = emojiFilenames(['👽', '⚾', '🐔', '☁️', '💨', '🕊️', '👀', '🍥', '👻', '🐐', '❕', '❔', '⛸️', '🌩️', '🔊', '🔇', '📃', '🌧️', '🐏', '🍚', '🍙', '🐓', '🐑', '💀', '☠️', '🌨️', '🔉', '🔈', '💬', '💭', '🏐', '🏳️', '⚪', '⬜', '◽', '◻️', '▫️']);\n\nconst emojiFilename = (filename) => {\n  const borderedEmoji = (document.body && document.body.classList.contains('theme-mastodon-light')) ? lightEmoji : darkEmoji;\n  return borderedEmoji.includes(filename) ? (filename + '_border') : filename;\n};\n\nconst emojifyTextNode = (node, customEmojis) => {\n  let str = node.textContent;\n\n  const fragment = new DocumentFragment();\n\n  for (;;) {\n    let match, i = 0;\n\n    if (customEmojis === null) {\n      while (i < str.length && !(match = trie.search(str.slice(i)))) {\n        i += str.codePointAt(i) < 65536 ? 1 : 2;\n      }\n    } else {\n      while (i < str.length && str[i] !== ':' && !(match = trie.search(str.slice(i)))) {\n        i += str.codePointAt(i) < 65536 ? 1 : 2;\n      }\n    }\n\n    let rend, replacement = null;\n    if (i === str.length) {\n      break;\n    } else if (str[i] === ':') {\n      if (!(() => {\n        rend = str.indexOf(':', i + 1) + 1;\n        if (!rend) return false; // no pair of ':'\n        const shortname = str.slice(i, rend);\n        // now got a replacee as ':shortname:'\n        // if you want additional emoji handler, add statements below which set replacement and return true.\n        if (shortname in customEmojis) {\n          const filename = autoPlayGif ? customEmojis[shortname].url : customEmojis[shortname].static_url;\n          replacement = document.createElement('img');\n          replacement.setAttribute('draggable', false);\n          replacement.setAttribute('class', 'emojione custom-emoji');\n          replacement.setAttribute('alt', shortname);\n          replacement.setAttribute('title', shortname);\n          replacement.setAttribute('src', filename);\n          replacement.setAttribute('data-original', customEmojis[shortname].url);\n          replacement.setAttribute('data-static', customEmojis[shortname].static_url);\n          return true;\n        }\n        return false;\n      })()) rend = ++i;\n    } else { // matched to unicode emoji\n      const { filename, shortCode } = unicodeMapping[match];\n      const title = shortCode ? `:${shortCode}:` : '';\n      replacement = document.createElement('img');\n      replacement.setAttribute('draggable', false);\n      replacement.setAttribute('class', 'emojione');\n      replacement.setAttribute('alt', match);\n      replacement.setAttribute('title', title);\n      replacement.setAttribute('src', `${assetHost}/emoji/${emojiFilename(filename)}.svg`);\n      rend = i + match.length;\n      // If the matched character was followed by VS15 (for selecting text presentation), skip it.\n      if (str.codePointAt(rend) === 65038) {\n        rend += 1;\n      }\n    }\n\n    fragment.append(document.createTextNode(str.slice(0, i)));\n    if (replacement) {\n      fragment.append(replacement);\n    }\n    str = str.slice(rend);\n  }\n\n  fragment.append(document.createTextNode(str));\n  node.parentElement.replaceChild(fragment, node);\n};\n\nconst emojifyNode = (node, customEmojis) => {\n  for (const child of node.childNodes) {\n    switch(child.nodeType) {\n    case Node.TEXT_NODE:\n      emojifyTextNode(child, customEmojis);\n      break;\n    case Node.ELEMENT_NODE:\n      if (!child.classList.contains('invisible'))\n        emojifyNode(child, customEmojis);\n      break;\n    }\n  }\n};\n\nconst emojify = (str, customEmojis = {}) => {\n  const wrapper = document.createElement('div');\n  wrapper.innerHTML = str;\n\n  if (!Object.keys(customEmojis).length)\n    customEmojis = null;\n\n  emojifyNode(wrapper, customEmojis);\n\n  return wrapper.innerHTML;\n};\n\nexport default emojify;\n\nexport const buildCustomEmojis = (customEmojis) => {\n  const emojis = [];\n\n  customEmojis.forEach(emoji => {\n    const shortcode = emoji.get('shortcode');\n    const url       = autoPlayGif ? emoji.get('url') : emoji.get('static_url');\n    const name      = shortcode.replace(':', '');\n\n    emojis.push({\n      id: name,\n      name,\n      short_names: [name],\n      text: '',\n      emoticons: [],\n      keywords: [name],\n      imageUrl: url,\n      custom: true,\n      customCategory: emoji.get('category'),\n    });\n  });\n\n  return emojis;\n};\n\nexport const categoriesFromEmojis = customEmojis => customEmojis.reduce((set, emoji) => set.add(emoji.get('category') ? `custom-${emoji.get('category')}` : 'custom'), new Set(['custom']));\n","import ready from '../ready';\n\nexport let assetHost = '';\n\nready(() => {\n  const cdnHost = document.querySelector('meta[name=cdn-host]');\n  if (cdnHost) {\n    assetHost = cdnHost.content || '';\n  }\n});\n","//  This file will be loaded on settings pages, regardless of theme.\n\nimport 'packs/public-path';\nimport escapeTextContentForBrowser from 'escape-html';\n\nconst { delegate } = require('@rails/ujs');\n\nimport emojify from '../mastodon/features/emoji/emoji';\n\ndelegate(document, '#account_display_name', 'input', ({ target }) => {\n  const name = document.querySelector('.card .display-name strong');\n  if (name) {\n    if (target.value) {\n      name.innerHTML = emojify(escapeTextContentForBrowser(target.value));\n    } else {\n      name.textContent = name.textContent = target.dataset.default;\n    }\n  }\n});\n\ndelegate(document, '#account_avatar', 'change', ({ target }) => {\n  const avatar = document.querySelector('.card .avatar img');\n  const [file] = target.files || [];\n  const url = file ? URL.createObjectURL(file) : avatar.dataset.originalSrc;\n\n  avatar.src = url;\n});\n\ndelegate(document, '#account_header', 'change', ({ target }) => {\n  const header = document.querySelector('.card .card__img img');\n  const [file] = target.files || [];\n  const url = file ? URL.createObjectURL(file) : header.dataset.originalSrc;\n\n  header.src = url;\n});\n\ndelegate(document, '#account_locked', 'change', ({ target }) => {\n  const lock = document.querySelector('.card .display-name i');\n\n  if (lock) {\n    if (target.checked) {\n      delete lock.dataset.hidden;\n    } else {\n      lock.dataset.hidden = 'true';\n    }\n  }\n});\n\ndelegate(document, '.input-copy input', 'click', ({ target }) => {\n  target.focus();\n  target.select();\n  target.setSelectionRange(0, target.value.length);\n});\n\ndelegate(document, '.input-copy button', 'click', ({ target }) => {\n  const input = target.parentNode.querySelector('.input-copy__wrapper input');\n\n  const oldReadOnly = input.readonly;\n\n  input.readonly = false;\n  input.focus();\n  input.select();\n  input.setSelectionRange(0, input.value.length);\n\n  try {\n    if (document.execCommand('copy')) {\n      input.blur();\n      target.parentNode.classList.add('copied');\n\n      setTimeout(() => {\n        target.parentNode.classList.remove('copied');\n      }, 700);\n    }\n  } catch (err) {\n    console.error(err);\n  }\n\n  input.readonly = oldReadOnly;\n});\n"],"sourceRoot":""}